{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///Routine.min.js","webpack:///webpack/bootstrap 1ca3dd81ab83bd12d16d","webpack:///./src/Routine.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_classCallCheck","instance","Constructor","TypeError","runAsynchronously","routine","operations","lastResult","promise","Promise","resolve","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","undefined","_step7","_loop","operation","value","then","args","invoke","_iterator7","Symbol","iterator","next","done","err","error","handlers","abort","Routine","handleError","reject","Object","defineProperty","_typeof","obj","constructor","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","scope","aborted","run:before","invocation:before","invocation:after","metadata","Map","isSynchronous","lastConditionMet","currentOperation","instanceMetadata","validateOperation","assign","addOperationInstanceMetadata","push","has","static","set","Error","name","get","addOperation","_this","_operation","eventName","_len","arguments","decorators","Array","_key","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","decorator","setScopeTo","_ref","_ref$isConstructor","isConstructor","_ref$hasMultipleArgs","hasMultipleArgs","_ref$respectAbort","respectAbort","_ref$recordIt","recordIt","_ref$runHandlers","runHandlers","_ref$scope","invocation","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","handle","result","isRunnable","run","unshift","bind","apply","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","aspect","event","_len2","_key2","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","handler","emit","operationsToPromisify","slice","prop","use","hasOwnProperty","as","_len3","_key3","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","runAspects","_len4","_key4","$invocation","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6"],"mappings":"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","file":"Routine.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"routine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"routine\"] = factory();\n\telse\n\t\troot[\"routine\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"routine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"routine\"] = factory();\n\telse\n\t\troot[\"routine\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Routine = function () {\n\t\tfunction Routine(scope) {\n\t\t\t_classCallCheck(this, Routine);\n\t\n\t\t\tthis.aborted = false;\n\t\t\tthis.handlers = {\n\t\t\t\t'run:before': [],\n\t\t\t\t'invocation:before': [],\n\t\t\t\t'invocation:after': []\n\t\t\t};\n\t\t\tthis.metadata = new Map();\n\t\t\tthis.operations = [];\n\t\t\tthis.isSynchronous = true;\n\t\t\tthis.lastConditionMet = undefined;\n\t\t\tthis.currentOperation = undefined;\n\t\n\t\t\tthis.scope = scope || {};\n\t\n\t\t\tthis.scope.routine = this;\n\t\t}\n\t\n\t\t_createClass(Routine, [{\n\t\t\tkey: 'addOperation',\n\t\t\tvalue: function addOperation(operation, instanceMetadata) {\n\t\n\t\t\t\tRoutine.validateOperation(operation);\n\t\n\t\t\t\tvar metadata = Object.assign(operation['@routine.metadata'] || {}, instanceMetadata || {});\n\t\n\t\t\t\tthis.addOperationInstanceMetadata(operation, metadata);\n\t\n\t\t\t\tthis.operations.push(operation);\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'addOperationInstanceMetadata',\n\t\t\tvalue: function addOperationInstanceMetadata(operation, instanceMetadata) {\n\t\t\t\tif (!this.metadata.has(operation)) {\n\t\t\t\t\tvar metadata = {\n\t\t\t\t\t\tinstance: {},\n\t\t\t\t\t\tstatic: {}\n\t\t\t\t\t};\n\t\n\t\t\t\t\tthis.metadata.set(operation, metadata);\n\t\t\t\t}\n\t\n\t\t\t\tif (instanceMetadata) {\n\t\t\t\t\tif ((typeof instanceMetadata === 'undefined' ? 'undefined' : _typeof(instanceMetadata)) !== 'object') {\n\t\t\t\t\t\tthrow new Error('Instance metadata must be an object - Instance metadata was ' + ('specified for an operation named ' + operation.name + ' but the instance metadata was ') + ('of type ' + (typeof operation === 'undefined' ? 'undefined' : _typeof(operation)) + '. Instance metadata must however be an object'));\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthis.metadata.get(operation).instance = instanceMetadata;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'first',\n\t\t\tvalue: function first(operation, instanceMetadata) {\n\t\t\t\tthis.addOperation(operation, instanceMetadata);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'then',\n\t\t\tvalue: function then(operation, instanceMetadata) {\n\t\t\t\tthis.addOperation(operation, instanceMetadata);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'otherwise',\n\t\t\tvalue: function otherwise(operation, instanceMetadata) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tthis.addOperationInstanceMetadata(operation, instanceMetadata);\n\t\t\t\tvar _operation = function _operation(args) {\n\t\t\t\t\tif (_this.lastConditionMet) {\n\t\t\t\t\t\t_this.abort();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn _this.invoke({ operation: operation, args: args });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\n\t\t\t\tthis.addOperation(_operation);\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'on',\n\t\t\tvalue: function on(eventName, operation) {\n\t\t\t\tRoutine.validateOperation(operation);\n\t\n\t\t\t\tif (!this.handlers[eventName]) {\n\t\t\t\t\tthis.handlers[eventName] = [];\n\t\t\t\t}\n\t\n\t\t\t\tthis.handlers[eventName].push(operation);\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'use',\n\t\t\tvalue: function use() {\n\t\t\t\tfor (var _len = arguments.length, decorators = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\t\t\tdecorators[_key] = arguments[_key];\n\t\t\t\t}\n\t\n\t\t\t\tvar _iteratorNormalCompletion = true;\n\t\t\t\tvar _didIteratorError = false;\n\t\t\t\tvar _iteratorError = undefined;\n\t\n\t\t\t\ttry {\n\t\n\t\t\t\t\tfor (var _iterator = decorators[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t\t\t\t\t\tvar decorator = _step.value;\n\t\n\t\t\t\t\t\tif (typeof decorator === 'function') {\n\t\t\t\t\t\t\tdecorator(this);\n\t\t\t\t\t\t} else if ((typeof decorator === 'undefined' ? 'undefined' : _typeof(decorator)) === 'object') {\n\t\t\t\t\t\t\tthis.setScopeTo(decorator);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\t_didIteratorError = true;\n\t\t\t\t\t_iteratorError = err;\n\t\t\t\t} finally {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_iteratorNormalCompletion && _iterator.return) {\n\t\t\t\t\t\t\t_iterator.return();\n\t\t\t\t\t\t}\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tif (_didIteratorError) {\n\t\t\t\t\t\t\tthrow _iteratorError;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'abort',\n\t\t\tvalue: function abort() {\n\t\t\t\tthis.aborted = true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'invoke',\n\t\t\tvalue: function invoke() {\n\t\t\t\tvar _ref = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t\t\t\tvar operation = _ref.operation;\n\t\t\t\tvar args = _ref.args;\n\t\t\t\tvar _ref$isConstructor = _ref.isConstructor;\n\t\t\t\tvar isConstructor = _ref$isConstructor === undefined ? false : _ref$isConstructor;\n\t\t\t\tvar _ref$hasMultipleArgs = _ref.hasMultipleArgs;\n\t\t\t\tvar hasMultipleArgs = _ref$hasMultipleArgs === undefined ? false : _ref$hasMultipleArgs;\n\t\t\t\tvar _ref$respectAbort = _ref.respectAbort;\n\t\t\t\tvar respectAbort = _ref$respectAbort === undefined ? true : _ref$respectAbort;\n\t\t\t\tvar _ref$recordIt = _ref.recordIt;\n\t\t\t\tvar recordIt = _ref$recordIt === undefined ? true : _ref$recordIt;\n\t\t\t\tvar _ref$runHandlers = _ref.runHandlers;\n\t\t\t\tvar runHandlers = _ref$runHandlers === undefined ? true : _ref$runHandlers;\n\t\t\t\tvar _ref$scope = _ref.scope;\n\t\t\t\tvar scope = _ref$scope === undefined ? this.scope : _ref$scope;\n\t\n\t\n\t\t\t\tvar invocation = {\n\t\t\t\t\toperation: operation,\n\t\t\t\t\targs: args,\n\t\t\t\t\tisConstructor: isConstructor,\n\t\t\t\t\thasMultipleArgs: hasMultipleArgs,\n\t\t\t\t\trespectAbort: respectAbort,\n\t\t\t\t\trecordIt: recordIt,\n\t\t\t\t\trunHandlers: runHandlers,\n\t\t\t\t\tscope: scope\n\t\t\t\t};\n\t\n\t\t\t\tif (invocation.runHandlers && this.handlers['invocation:before']) {\n\t\t\t\t\tvar _iteratorNormalCompletion2 = true;\n\t\t\t\t\tvar _didIteratorError2 = false;\n\t\t\t\t\tvar _iteratorError2 = undefined;\n\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfor (var _iterator2 = this.handlers['invocation:before'][Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t\t\t\t\t\t\tvar handle = _step2.value;\n\t\n\t\t\t\t\t\t\thandle(invocation);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t_didIteratorError2 = true;\n\t\t\t\t\t\t_iteratorError2 = err;\n\t\t\t\t\t} finally {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t\t\t\t\t\t\t\t_iterator2.return();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tif (_didIteratorError2) {\n\t\t\t\t\t\t\t\tthrow _iteratorError2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (invocation.respectAbort && this.aborted) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (invocation.recordIt) {\n\t\t\t\t\tthis.currentOperation = invocation.operation;\n\t\t\t\t}\n\t\n\t\t\t\tvar result = void 0;\n\t\n\t\t\t\tif (Routine.isRunnable(invocation.operation)) {\n\t\t\t\t\tresult = invocation.operation.run(this, invocation.args);\n\t\t\t\t} else if (isConstructor) {\n\t\t\t\t\tif (invocation.hasMultipleArgs) {\n\t\t\t\t\t\tinvocation.args.unshift(null);\n\t\t\t\t\t\tresult = new (invocation.operation.bind.apply(invocation.operation, invocation.args))();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = new invocation.operation(invocation.args); // eslint-disable-line new-cap\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (invocation.hasMultipleArgs) {\n\t\t\t\t\t\tresult = invocation.operation.apply(invocation.scope, invocation.args);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = invocation.operation.call(invocation.scope, invocation.args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (runHandlers && this.handlers['invocation:after']) {\n\t\t\t\t\tvar _iteratorNormalCompletion3 = true;\n\t\t\t\t\tvar _didIteratorError3 = false;\n\t\t\t\t\tvar _iteratorError3 = undefined;\n\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfor (var _iterator3 = this.handlers['invocation:after'][Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t\t\t\t\t\t\tvar aspect = _step3.value;\n\t\n\t\t\t\t\t\t\taspect({ operation: operation, args: args, hasMultipleArgs: hasMultipleArgs, respectAbort: respectAbort, recordIt: recordIt, result: result });\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t_didIteratorError3 = true;\n\t\t\t\t\t\t_iteratorError3 = err;\n\t\t\t\t\t} finally {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t\t\t\t\t\t\t\t_iterator3.return();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tif (_didIteratorError3) {\n\t\t\t\t\t\t\t\tthrow _iteratorError3;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'emit',\n\t\t\tvalue: function emit(event) {\n\t\t\t\tfor (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n\t\t\t\t\targs[_key2 - 1] = arguments[_key2];\n\t\t\t\t}\n\t\n\t\t\t\tvar _iteratorNormalCompletion4 = true;\n\t\t\t\tvar _didIteratorError4 = false;\n\t\t\t\tvar _iteratorError4 = undefined;\n\t\n\t\t\t\ttry {\n\t\t\t\t\tfor (var _iterator4 = this.handlers[event][Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t\t\t\t\t\tvar handler = _step4.value;\n\t\n\t\t\t\t\t\thandler.apply(null, args);\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\t_didIteratorError4 = true;\n\t\t\t\t\t_iteratorError4 = err;\n\t\t\t\t} finally {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t\t\t\t\t\t\t_iterator4.return();\n\t\t\t\t\t\t}\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tif (_didIteratorError4) {\n\t\t\t\t\t\t\tthrow _iteratorError4;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'run',\n\t\t\tvalue: function run() {\n\t\n\t\t\t\tthis.emit('run:before');\n\t\n\t\t\t\tvar lastResult = void 0;\n\t\n\t\t\t\ttry {\n\t\t\t\t\tfor (var i = 0; i < this.operations.length; i++) {\n\t\t\t\t\t\tvar operation = this.operations[i];\n\t\n\t\t\t\t\t\tlastResult = this.invoke({\n\t\t\t\t\t\t\toperation: operation,\n\t\t\t\t\t\t\targs: lastResult\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tif (lastResult instanceof Promise) {\n\t\t\t\t\t\t\tthis.isSynchronous = false;\n\t\t\t\t\t\t\tvar operationsToPromisify = this.operations.slice(i + 1, this.operations.length);\n\t\t\t\t\t\t\treturn runAsynchronously(this, operationsToPromisify, lastResult);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn lastResult;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tRoutine.handleError(this, error);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setScopeTo',\n\t\t\tvalue: function setScopeTo(scope) {\n\t\t\t\tfor (var prop in scope) {\n\t\t\t\t\tif (prop === '@routine.use') {\n\t\t\t\t\t\tthis.use.apply(this, scope[prop]);\n\t\t\t\t\t} else if (prop !== 'routine' && scope.hasOwnProperty(prop)) {\n\t\t\t\t\t\tthis.scope[prop] = scope[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setup',\n\t\t\tget: function get() {\n\t\t\t\treturn {\n\t\t\t\t\tas: function as() {\n\t\t\t\t\t\tfor (var _len3 = arguments.length, operations = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n\t\t\t\t\t\t\toperations[_key3] = arguments[_key3];\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tvar _iteratorNormalCompletion5 = true;\n\t\t\t\t\t\tvar _didIteratorError5 = false;\n\t\t\t\t\t\tvar _iteratorError5 = undefined;\n\t\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tfor (var _iterator5 = operations[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n\t\t\t\t\t\t\t\tvar operation = _step5.value;\n\t\n\t\t\t\t\t\t\t\tRoutine.validateOperation(operation);\n\t\t\t\t\t\t\t\tthis.invoke({\n\t\t\t\t\t\t\t\t\toperation: operation,\n\t\t\t\t\t\t\t\t\targs: this,\n\t\t\t\t\t\t\t\t\trespectAbort: false,\n\t\t\t\t\t\t\t\t\trunAspects: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t_didIteratorError5 = true;\n\t\t\t\t\t\t\t_iteratorError5 = err;\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tif (!_iteratorNormalCompletion5 && _iterator5.return) {\n\t\t\t\t\t\t\t\t\t_iterator5.return();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\t\tif (_didIteratorError5) {\n\t\t\t\t\t\t\t\t\tthrow _iteratorError5;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'and',\n\t\t\tget: function get() {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'but',\n\t\t\tget: function get() {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'use',\n\t\t\tvalue: function use() {\n\t\t\t\tvar routine = new Routine();\n\t\n\t\t\t\tfor (var _len4 = arguments.length, decorators = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n\t\t\t\t\tdecorators[_key4] = arguments[_key4];\n\t\t\t\t}\n\t\n\t\t\t\troutine.use.apply(routine, decorators);\n\t\t\t\treturn routine;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setScopeTo',\n\t\t\tvalue: function setScopeTo(scope) {\n\t\t\t\treturn new Routine(scope);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'isRunnable',\n\t\t\tvalue: function isRunnable(operation) {\n\t\t\t\treturn (typeof operation === 'undefined' ? 'undefined' : _typeof(operation)) === 'object' && operation.run !== undefined;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'validateOperation',\n\t\t\tvalue: function validateOperation(operation) {\n\t\t\t\tif (!Routine.isRunnable(operation) && typeof operation !== 'function') {\n\t\t\t\t\tthrow new Error('Invalid operation type - An operation has to ' + 'either be a function or an object with a `run()` method. Instead an operation of type ' + ('\\'' + (typeof operation === 'undefined' ? 'undefined' : _typeof(operation)) + '\\' was supplied.'));\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'handleError',\n\t\t\tvalue: function handleError(routine, error) {\n\t\t\t\troutine.scope.error = error;\n\t\n\t\t\t\terror.$invocation = {\n\t\t\t\t\toperation: routine.currentOperation ? routine.currentOperation.name : 'unknown operation'\n\t\t\t\t};\n\t\n\t\t\t\tif (routine.handlers.error) {\n\t\t\t\t\tvar _iteratorNormalCompletion6 = true;\n\t\t\t\t\tvar _didIteratorError6 = false;\n\t\t\t\t\tvar _iteratorError6 = undefined;\n\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfor (var _iterator6 = routine.handlers.error[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n\t\t\t\t\t\t\tvar operation = _step6.value;\n\t\n\t\t\t\t\t\t\troutine.invoke({\n\t\t\t\t\t\t\t\toperation: operation,\n\t\t\t\t\t\t\t\targs: error,\n\t\t\t\t\t\t\t\trecordIt: false,\n\t\t\t\t\t\t\t\trespectAbort: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t_didIteratorError6 = true;\n\t\t\t\t\t\t_iteratorError6 = err;\n\t\t\t\t\t} finally {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (!_iteratorNormalCompletion6 && _iterator6.return) {\n\t\t\t\t\t\t\t\t_iterator6.return();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tif (_didIteratorError6) {\n\t\t\t\t\t\t\t\tthrow _iteratorError6;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (routine.isSynchronous) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Routine;\n\t}();\n\t\n\texports.default = Routine;\n\t\n\t\n\tfunction runAsynchronously(routine, operations, lastResult) {\n\t\tvar promise = Promise.resolve(lastResult);\n\t\n\t\tvar _iteratorNormalCompletion7 = true;\n\t\tvar _didIteratorError7 = false;\n\t\tvar _iteratorError7 = undefined;\n\t\n\t\ttry {\n\t\t\tvar _loop = function _loop() {\n\t\t\t\tvar operation = _step7.value;\n\t\n\t\t\t\tpromise = promise.then(function (args) {\n\t\t\t\t\treturn routine.invoke({\n\t\t\t\t\t\toperation: operation,\n\t\t\t\t\t\targs: args\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\t\n\t\t\tfor (var _iterator7 = operations[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n\t\t\t\t_loop();\n\t\t\t}\n\t\t} catch (err) {\n\t\t\t_didIteratorError7 = true;\n\t\t\t_iteratorError7 = err;\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (!_iteratorNormalCompletion7 && _iterator7.return) {\n\t\t\t\t\t_iterator7.return();\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif (_didIteratorError7) {\n\t\t\t\t\tthrow _iteratorError7;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\tpromise = promise.catch(function (error) {\n\t\t\tif (routine.handlers.error) {\n\t\t\t\troutine.abort();\n\t\t\t\treturn new Promise(function (resolve) {\n\t\t\t\t\tRoutine.handleError(routine, error);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\treturn Promise.reject(error);\n\t\t});\n\t\n\t\treturn promise;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** Routine.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1ca3dd81ab83bd12d16d\n **/","export default class Routine {\n\n\taborted = false;\n\n\thandlers = {\n\t\t'run:before': [],\n\t\t'invocation:before': [],\n\t\t'invocation:after': []\n\t};\n\n\tmetadata = new Map();\n\n\toperations = [];\n\n\tisSynchronous = true;\n\n\tlastConditionMet = undefined;\n\n\tcurrentOperation = undefined;\n\n\tconstructor (scope) {\n\t\tthis.scope = scope || {};\n\n\t\tthis.scope.routine = this;\n\t}\n\n\taddOperation (operation, instanceMetadata) {\n\n\t\tRoutine.validateOperation(operation);\n\n\t\tconst metadata = Object.assign(operation['@routine.metadata'] || {}, instanceMetadata || {});\n\n\t\tthis.addOperationInstanceMetadata(operation, metadata);\n\n\t\tthis.operations.push(operation);\n\n\t\treturn this;\n\t}\n\n\taddOperationInstanceMetadata (operation, instanceMetadata) {\n\t\tif (!this.metadata.has(operation)) {\n\t\t\tconst metadata = {\n\t\t\t\tinstance: {},\n\t\t\t\tstatic: {}\n\t\t\t};\n\n\t\t\tthis.metadata.set(operation, metadata);\n\t\t}\n\n\t\tif (instanceMetadata) {\n\t\t\tif (typeof instanceMetadata !== 'object') {\n\t\t\t\tthrow new Error('Instance metadata must be an object - Instance metadata was ' +\n\t\t\t\t\t`specified for an operation named ${operation.name} but the instance metadata was ` +\n\t\t\t\t\t`of type ${typeof operation}. Instance metadata must however be an object`);\n\t\t\t}\n\n\t\t\tthis.metadata.get(operation).instance = instanceMetadata;\n\t\t}\n\t}\n\n\tfirst (operation, instanceMetadata) {\n\t\tthis.addOperation(operation, instanceMetadata);\n\t\treturn this;\n\t}\n\n\tthen (operation, instanceMetadata) {\n\t\tthis.addOperation(operation, instanceMetadata);\n\t\treturn this;\n\t}\n\n\totherwise (operation, instanceMetadata) {\n\t\tthis.addOperationInstanceMetadata(operation, instanceMetadata);\n\t\tconst _operation = (args) => {\n\t\t\tif (this.lastConditionMet) {\n\t\t\t\tthis.abort();\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.invoke({operation, args});\n\t\t\t}\n\t\t};\n\n\t\tthis.addOperation(_operation);\n\n\t\treturn this;\n\t}\n\n\ton (eventName, operation) {\n\t\tRoutine.validateOperation(operation);\n\n\t\tif (!this.handlers[eventName]) {\n\t\t\tthis.handlers[eventName] = [];\n\t\t}\n\n\t\tthis.handlers[eventName].push(operation);\n\n\t\treturn this;\n\t}\n\n\tuse (...decorators) {\n\n\t\tfor (let decorator of decorators) {\n\t\t\tif (typeof decorator === 'function') {\n\t\t\t\tdecorator(this);\n\t\t\t}\n\t\t\telse if (typeof decorator === 'object') {\n\t\t\t\tthis.setScopeTo(decorator);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget setup () {\n\t\treturn {\n\t\t\tas (...operations) {\n\t\t\t\tfor (let operation of operations) {\n\t\t\t\t\tRoutine.validateOperation(operation);\n\t\t\t\t\tthis.invoke({\n\t\t\t\t\t\toperation,\n\t\t\t\t\t\targs: this,\n\t\t\t\t\t\trespectAbort: false,\n\t\t\t\t\t\trunAspects: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tget and () {\n\t\treturn this;\n\t}\n\n\tget but () {\n\t\treturn this;\n\t}\n\n\tabort () {\n\t\tthis.aborted = true;\n\t}\n\n\tinvoke ({\n\t\toperation,\n\t\targs,\n\t\tisConstructor = false,\n\t\thasMultipleArgs = false,\n\t\trespectAbort = true,\n\t\trecordIt = true,\n\t\trunHandlers = true,\n\t\tscope = this.scope\n\t} = {}) {\n\n\t\tconst invocation = {\n\t\t\toperation,\n\t\t\targs,\n\t\t\tisConstructor,\n\t\t\thasMultipleArgs,\n\t\t\trespectAbort,\n\t\t\trecordIt,\n\t\t\trunHandlers,\n\t\t\tscope\n\t\t};\n\n\t\tif (invocation.runHandlers && this.handlers['invocation:before']) {\n\t\t\tfor (let handle of this.handlers['invocation:before']) {\n\t\t\t\thandle(invocation);\n\t\t\t}\n\t\t}\n\n\t\tif (invocation.respectAbort && this.aborted) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (invocation.recordIt) {\n\t\t\tthis.currentOperation = invocation.operation;\n\t\t}\n\n\t\tlet result;\n\n\t\tif (Routine.isRunnable(invocation.operation)) {\n\t\t\tresult = invocation.operation.run(this, invocation.args);\n\t\t}\n\t\telse if (isConstructor) {\n\t\t\tif (invocation.hasMultipleArgs) {\n\t\t\t\tinvocation.args.unshift(null);\n\t\t\t\tresult = new (invocation.operation.bind.apply(invocation.operation, invocation.args));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = new invocation.operation(invocation.args); // eslint-disable-line new-cap\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (invocation.hasMultipleArgs) {\n\t\t\t\tresult = invocation.operation.apply(invocation.scope, invocation.args);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = invocation.operation.call(invocation.scope, invocation.args);\n\t\t\t}\n\t\t}\n\n\t\tif (runHandlers && this.handlers['invocation:after']) {\n\t\t\tfor (let aspect of this.handlers['invocation:after']) {\n\t\t\t\taspect({operation, args, hasMultipleArgs, respectAbort, recordIt, result});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\temit (event, ...args) {\n\t\tfor (let handler of this.handlers[event]) {\n\t\t\thandler.apply(null, args);\n\t\t}\n\t}\n\n\trun () {\n\n\t\tthis.emit('run:before');\n\n\t\tlet lastResult;\n\n\t\ttry {\n\t\t\tfor (let i = 0; i < this.operations.length; i++) {\n\t\t\t\tlet operation = this.operations[i];\n\n\t\t\t\tlastResult = this.invoke({\n\t\t\t\t\toperation,\n\t\t\t\t\targs: lastResult\n\t\t\t\t});\n\n\t\t\t\tif (lastResult instanceof Promise) {\n\t\t\t\t\tthis.isSynchronous = false;\n\t\t\t\t\tconst operationsToPromisify = this.operations.slice(i + 1, this.operations.length);\n\t\t\t\t\treturn runAsynchronously(this, operationsToPromisify, lastResult);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn lastResult;\n\t\t}\n\t\tcatch (error) {\n\t\t\tRoutine.handleError(this, error);\n\t\t}\n\t}\n\n\tsetScopeTo (scope) {\n\t\tfor (let prop in scope) {\n\t\t\tif (prop === '@routine.use') {\n\t\t\t\tthis.use.apply(this, scope[prop]);\n\t\t\t}\n\t\t\telse if (prop !== 'routine' && scope.hasOwnProperty(prop)) {\n\t\t\t\tthis.scope[prop] = scope[prop];\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tstatic use (...decorators) {\n\t\tconst routine = new Routine();\n\t\troutine.use.apply(routine, decorators);\n\t\treturn routine;\n\t}\n\n\tstatic setScopeTo (scope) {\n\t\treturn new Routine(scope);\n\t}\n\n\tstatic isRunnable (operation) {\n\t\treturn typeof operation === 'object' && operation.run !== undefined;\n\t}\n\n\tstatic validateOperation (operation) {\n\t\tif (!Routine.isRunnable(operation) && typeof operation !== 'function') {\n\t\t\tthrow new Error('Invalid operation type - An operation has to ' +\n\t\t\t\t'either be a function or an object with a `run()` method. Instead an operation of type ' +\n\t\t\t\t`'${typeof operation}' was supplied.`);\n\t\t}\n\t}\n\n\tstatic handleError (routine, error) {\n\t\troutine.scope.error = error;\n\n\t\terror.$invocation = {\n\t\t\toperation: routine.currentOperation ? routine.currentOperation.name : 'unknown operation'\n\t\t};\n\n\t\tif (routine.handlers.error) {\n\t\t\tfor (let operation of routine.handlers.error) {\n\t\t\t\troutine.invoke({\n\t\t\t\t\toperation: operation,\n\t\t\t\t\targs: error,\n\t\t\t\t\trecordIt: false,\n\t\t\t\t\trespectAbort: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (routine.isSynchronous) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nfunction runAsynchronously (routine, operations, lastResult) {\n\tlet promise = Promise.resolve(lastResult);\n\n\tfor (let operation of operations) {\n\t\tpromise = promise.then((args)=> {\n\t\t\treturn routine.invoke({\n\t\t\t\toperation,\n\t\t\t\targs\n\t\t\t});\n\t\t});\n\t}\n\n\tpromise = promise.catch(error => {\n\t\tif (routine.handlers.error) {\n\t\t\troutine.abort();\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tRoutine.handleError(routine, error);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\n\t\treturn Promise.reject(error);\n\t});\n\n\treturn promise;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Routine.js\n **/"],"sourceRoot":""}