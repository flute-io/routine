{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap c421a17ba700e82b5bb5","webpack:///./src/Routine.js"],"names":[],"mappings":"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","file":"Routine.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"routine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"routine\"] = factory();\n\telse\n\t\troot[\"routine\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c421a17ba700e82b5bb5\n **/","export default class Routine {\n\n\taborted = false;\n\n\thandlers = {\n\t\t'run:before': [],\n\t\t'invocation:before': [],\n\t\t'invocation:after': []\n\t};\n\n\tmetadata = new Map();\n\n\toperations = [];\n\n\tisSynchronous = true;\n\n\tlastConditionMet = undefined;\n\n\tcurrentOperation = undefined;\n\n\tconstructor (scope) {\n\t\tthis.scope = scope || {};\n\n\t\tthis.scope.routine = this;\n\t}\n\n\taddOperation (operation, instanceMetadata) {\n\n\t\tRoutine.validateOperation(operation);\n\n\t\tconst metadata = Object.assign(operation['@routine.metadata'] || {}, instanceMetadata || {});\n\n\t\tthis.addOperationInstanceMetadata(operation, metadata);\n\n\t\tthis.operations.push(operation);\n\n\t\treturn this;\n\t}\n\n\taddOperationInstanceMetadata (operation, instanceMetadata) {\n\t\tif (!this.metadata.has(operation)) {\n\t\t\tconst metadata = {\n\t\t\t\tinstance: {},\n\t\t\t\tstatic: {}\n\t\t\t};\n\n\t\t\tthis.metadata.set(operation, metadata);\n\t\t}\n\n\t\tif (instanceMetadata) {\n\t\t\tif (typeof instanceMetadata !== 'object') {\n\t\t\t\tthrow new Error('Instance metadata must be an object - Instance metadata was ' +\n\t\t\t\t\t`specified for an operation named ${operation.name} but the instance metadata was ` +\n\t\t\t\t\t`of type ${typeof operation}. Instance metadata must however be an object`);\n\t\t\t}\n\n\t\t\tthis.metadata.get(operation).instance = instanceMetadata;\n\t\t}\n\t}\n\n\tfirst (operation, instanceMetadata) {\n\t\tthis.addOperation(operation, instanceMetadata);\n\t\treturn this;\n\t}\n\n\tthen (operation, instanceMetadata) {\n\t\tthis.addOperation(operation, instanceMetadata);\n\t\treturn this;\n\t}\n\n\totherwise (operation, instanceMetadata) {\n\t\tthis.addOperationInstanceMetadata(operation, instanceMetadata);\n\t\tconst _operation = (args) => {\n\t\t\tif (this.lastConditionMet) {\n\t\t\t\tthis.abort();\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.invoke({operation, args});\n\t\t\t}\n\t\t};\n\n\t\tthis.addOperation(_operation);\n\n\t\treturn this;\n\t}\n\n\ton (eventName, operation) {\n\t\tRoutine.validateOperation(operation);\n\n\t\tif (!this.handlers[eventName]) {\n\t\t\tthis.handlers[eventName] = [];\n\t\t}\n\n\t\tthis.handlers[eventName].push(operation);\n\n\t\treturn this;\n\t}\n\n\tuse (...decorators) {\n\n\t\tfor (let decorator of decorators) {\n\t\t\tif (typeof decorator === 'function') {\n\t\t\t\tdecorator(this);\n\t\t\t}\n\t\t\telse if (typeof decorator === 'object') {\n\t\t\t\tthis.setScopeTo(decorator);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tget setup () {\n\t\treturn {\n\t\t\tas (...operations) {\n\t\t\t\tfor (let operation of operations) {\n\t\t\t\t\tRoutine.validateOperation(operation);\n\t\t\t\t\tthis.invoke({\n\t\t\t\t\t\toperation,\n\t\t\t\t\t\targs: this,\n\t\t\t\t\t\trespectAbort: false,\n\t\t\t\t\t\trunAspects: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tget and () {\n\t\treturn this;\n\t}\n\n\tget but () {\n\t\treturn this;\n\t}\n\n\tabort () {\n\t\tthis.aborted = true;\n\t}\n\n\tinvoke ({\n\t\toperation,\n\t\targs,\n\t\tisConstructor = false,\n\t\thasMultipleArgs = false,\n\t\trespectAbort = true,\n\t\trecordIt = true,\n\t\trunHandlers = true,\n\t\tscope = this.scope\n\t} = {}) {\n\n\t\tconst invocation = {\n\t\t\toperation,\n\t\t\targs,\n\t\t\thasMultipleArgs,\n\t\t\trespectAbort,\n\t\t\trecordIt,\n\t\t\trunHandlers,\n\t\t\tscope\n\t\t};\n\n\t\tif (invocation.runHandlers && this.handlers['invocation:before']) {\n\t\t\tfor (let handle of this.handlers['invocation:before']) {\n\t\t\t\thandle(invocation);\n\t\t\t}\n\t\t}\n\n\t\tif (invocation.respectAbort && this.aborted) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (invocation.recordIt) {\n\t\t\tthis.currentOperation = invocation.operation;\n\t\t}\n\n\t\tlet result;\n\n\t\tif (Routine.isRunnable(invocation.operation)) {\n\t\t\tresult = invocation.operation.run(this, invocation.args);\n\t\t}\n\t\telse if (isConstructor) {\n\t\t\tif (invocation.hasMultipleArgs) {\n\t\t\t\tinvocation.args.unshift(null);\n\t\t\t\tresult = new (invocation.operation.bind.apply(invocation.operation, invocation.args));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = new invocation.operation(invocation.args); // eslint-disable-line new-cap\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (invocation.hasMultipleArgs) {\n\t\t\t\tresult = invocation.operation.apply(invocation.scope, invocation.args);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = invocation.operation.call(invocation.scope, invocation.args);\n\t\t\t}\n\t\t}\n\n\t\tif (runHandlers && this.handlers['invocation:after']) {\n\t\t\tfor (let aspect of this.handlers['invocation:after']) {\n\t\t\t\taspect({operation, args, hasMultipleArgs, respectAbort, recordIt, result});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\temit (event, ...args) {\n\t\tfor (let handler of this.handlers[event]) {\n\t\t\thandler.apply(null, args);\n\t\t}\n\t}\n\n\trun () {\n\n\t\tthis.emit('run:before');\n\n\t\tlet lastResult;\n\n\t\ttry {\n\t\t\tfor (let i = 0; i < this.operations.length; i++) {\n\t\t\t\tlet operation = this.operations[i];\n\n\t\t\t\tlastResult = this.invoke({\n\t\t\t\t\toperation,\n\t\t\t\t\targs: lastResult\n\t\t\t\t});\n\n\t\t\t\tif (lastResult instanceof Promise) {\n\t\t\t\t\tthis.isSynchronous = false;\n\t\t\t\t\tconst operationsToPromisify = this.operations.slice(i + 1, this.operations.length);\n\t\t\t\t\treturn runAsynchronously(this, operationsToPromisify, lastResult);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn lastResult;\n\t\t}\n\t\tcatch (error) {\n\t\t\tRoutine.handleError(this, error);\n\t\t}\n\t}\n\n\tsetScopeTo (scope) {\n\t\tfor (let prop in scope) {\n\t\t\tif (prop === '@routine.use') {\n\t\t\t\tthis.use.apply(this, scope[prop]);\n\t\t\t}\n\t\t\telse if (prop !== 'routine' && scope.hasOwnProperty(prop)) {\n\t\t\t\tthis.scope[prop] = scope[prop];\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tstatic use (...decorators) {\n\t\tconst routine = new Routine();\n\t\troutine.use.apply(routine, decorators);\n\t\treturn routine;\n\t}\n\n\tstatic setScopeTo (scope) {\n\t\treturn new Routine(scope);\n\t}\n\n\tstatic isRunnable (operation) {\n\t\treturn typeof operation === 'object' && operation.run !== undefined;\n\t}\n\n\tstatic validateOperation (operation) {\n\t\tif (!Routine.isRunnable(operation) && typeof operation !== 'function') {\n\t\t\tthrow new Error('Invalid operation type - An operation has to ' +\n\t\t\t\t'either be a function or an object with a `run()` method. Instead an operation of type ' +\n\t\t\t\t`'${typeof operation}' was supplied.`);\n\t\t}\n\t}\n\n\tstatic handleError (routine, error) {\n\t\troutine.scope.error = error;\n\n\t\terror.$invocation = {\n\t\t\toperation: routine.currentOperation ? routine.currentOperation.name : 'unknown operation'\n\t\t};\n\n\t\tif (routine.handlers.error) {\n\t\t\tfor (let operation of routine.handlers.error) {\n\t\t\t\troutine.invoke({\n\t\t\t\t\toperation: operation,\n\t\t\t\t\targs: error,\n\t\t\t\t\trecordIt: false,\n\t\t\t\t\trespectAbort: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (routine.isSynchronous) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nfunction runAsynchronously (routine, operations, lastResult) {\n\tlet promise = Promise.resolve(lastResult);\n\n\tfor (let operation of operations) {\n\t\tpromise = promise.then((args)=> {\n\t\t\treturn routine.invoke({\n\t\t\t\toperation,\n\t\t\t\targs\n\t\t\t});\n\t\t});\n\t}\n\n\tpromise = promise.catch(error => {\n\t\tif (routine.handlers.error) {\n\t\t\troutine.abort();\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tRoutine.handleError(routine, error);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\n\t\treturn Promise.reject(error);\n\t});\n\n\treturn promise;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Routine.js\n **/"],"sourceRoot":""}