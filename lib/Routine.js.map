{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///webpack/bootstrap c98e0ea619010e176593?ad30","webpack:///./src/Routine.js"],"names":[],"mappings":"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","file":"Routine.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"routine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"routine\"] = factory();\n\telse\n\t\troot[\"routine\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c98e0ea619010e176593\n **/","// export {ensureThat} from './EnsureThat'; // TODO: Uncomment or remove\n\nexport default class Routine {\n\n\taborted = false;\n\n\toperations = [];\n\n\thandlers = {};\n\n\tcurrentOperation = undefined;\n\n\tisSynchronous = true;\n\n\taspects = {\n\t\tinvocation: {\n\t\t\tbefore: [],\n\t\t\tafter: []\n\t\t}\n\t};\n\n\tconstructor (scope) {\n\t\tthis.scope = scope;\n\n\t\tscope.routine = this;\n\t}\n\n\taddOperation (operation) {\n\n\t\tRoutine.validateOperation(operation);\n\n\t\tthis.operations.push(operation);\n\n\t\treturn this;\n\t}\n\n\tfirst (operation) {\n\t\tthis.addOperation(operation);\n\t\treturn this;\n\t}\n\n\tthen (operation) {\n\t\tthis.addOperation(operation);\n\t\treturn this;\n\t}\n\n\ton (eventName, operation) {\n\t\tRoutine.validateOperation(operation);\n\n\t\tthis.handlers[eventName] = (arg) => {\n\t\t\treturn operation.call(this.scope, arg);\n\t\t};\n\t\treturn this;\n\t}\n\n\tget setup () {\n\t\treturn {\n\t\t\tas (...operations) {\n\t\t\t\tfor (let operation of operations) {\n\t\t\t\t\tRoutine.validateOperation(operation);\n\t\t\t\t\tthis.invoke({\n\t\t\t\t\t\toperation,\n\t\t\t\t\t\targs: this,\n\t\t\t\t\t\trespectAbort: false,\n\t\t\t\t\t\trunAspects: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tget and () {\n\t\treturn this;\n\t}\n\n\tget but () {\n\t\treturn this;\n\t}\n\n\tabort () {\n\t\tthis.aborted = true;\n\t}\n\n\tinvoke ({operation, args, hasMultipleArgs = false, respectAbort = true, recordIt = true, runAspects = true} = {}) {\n\n\t\tif (runAspects) {\n\t\t\tfor (let aspect of this.aspects.invocation.before) {\n\t\t\t\taspect({operation, args, hasMultipleArgs, respectAbort, recordIt});\n\t\t\t}\n\t\t}\n\n\t\tif (respectAbort && this.aborted) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (recordIt) {\n\t\t\tthis.currentOperation = operation;\n\t\t}\n\n\t\tlet result;\n\n\t\tif (Routine.isRunnable(operation)) {\n\t\t\tresult = operation.run(this);\n\t\t}\n\t\telse {\n\t\t\tif (hasMultipleArgs) {\n\t\t\t\tresult = operation.apply(this.scope, args);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = operation.call(this.scope, args);\n\t\t\t}\n\t\t}\n\n\t\tif (runAspects) {\n\t\t\tfor (let aspect of this.aspects.invocation.after) {\n\t\t\t\taspect({operation, args, hasMultipleArgs, respectAbort, recordIt, result});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\trun () {\n\t\tlet lastResult;\n\n\t\ttry {\n\t\t\tfor (let i = 0; i < this.operations.length; i++) {\n\t\t\t\tlet operation = this.operations[i];\n\n\t\t\t\tlastResult = this.invoke({\n\t\t\t\t\toperation,\n\t\t\t\t\targs: lastResult\n\t\t\t\t});\n\n\t\t\t\tif (lastResult instanceof Promise) {\n\t\t\t\t\tthis.isSynchronous = false;\n\t\t\t\t\tconst operationsToPromisify = this.operations.slice(i + 1, this.operations.length);\n\t\t\t\t\treturn runAsynchronously(this, operationsToPromisify, lastResult);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn lastResult;\n\t\t}\n\t\tcatch (error) {\n\t\t\tRoutine.handleError(this, error);\n\t\t}\n\t}\n\n\tstatic set (scope) {\n\t\treturn new Routine(scope);\n\t}\n\n\tstatic isRunnable (operation) {\n\t\treturn typeof operation === 'object' && operation.run !== undefined;\n\t}\n\n\tstatic validateOperation (operation) {\n\t\tif (!Routine.isRunnable(operation) && typeof operation !== 'function') {\n\t\t\tthrow new Error('Invalid operation type - An operation has to ' +\n\t\t\t\t'either be a function or an object with a `run()` method. Instead an operation of type ' +\n\t\t\t\t`'${typeof operation}' was supplied.`);\n\t\t}\n\t}\n\n\tstatic handleError (routine, error) {\n\t\terror.$state = routine.scope.state;\n\t\terror.$invocation = {\n\t\t\toperation: routine.currentOperation.name\n\t\t};\n\n\t\tif (routine.handlers.error) {\n\t\t\troutine.invoke({\n\t\t\t\toperation: routine.handlers.error,\n\t\t\t\targs: error,\n\t\t\t\trecordIt: false,\n\t\t\t\trespectAbort: false\n\t\t\t});\n\t\t}\n\t\telse if (routine.isSynchronous) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nfunction runAsynchronously (routine, operations, lastResult) {\n\tlet promise = Promise.resolve(lastResult);\n\n\tfor (let operation of operations) {\n\t\tpromise = promise.then((args)=> {\n\t\t\treturn routine.invoke({\n\t\t\t\toperation,\n\t\t\t\targs\n\t\t\t});\n\t\t});\n\t}\n\n\tpromise = promise.catch(error => {\n\t\tif (routine.handlers.error) {\n\t\t\troutine.abort();\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tRoutine.handleError(routine, error);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\n\t\treturn Promise.reject(error);\n\t});\n\n\treturn promise;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Routine.js\n **/"],"sourceRoot":""}