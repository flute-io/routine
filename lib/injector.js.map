{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6***","webpack:///webpack/bootstrap a13018de3fce7b688ef8?b307***","webpack:///./src/injector.js"],"names":[],"mappings":"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","file":"injector.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"routine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"routine\"] = factory();\n\telse\n\t\troot[\"routine\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap a13018de3fce7b688ef8\n **/","export default function $injector (routine) {\n\n\troutine.on('invocation:before', (invocation) => {\n\n\t\tconst metadata = routine.metadata.get(injector);\n\t\tconst mappings = metadata ? metadata.mappings || {} : {};\n\t\tconst depNames = $args(invocation.operation);\n\t\tconst depsToInject = [];\n\n\t\tfor (let argName of depNames) {\n\t\t\tif (argName === 'routine') {\n\t\t\t\tdepsToInject.push(routine);\n\t\t\t}\n\t\t\telse if (mappings[argName]) {\n\t\t\t\tconst arg = getItemFromObjByStringPath({\n\t\t\t\t\tobj: routine.scope,\n\t\t\t\t\tpath: mappings[argName]\n\t\t\t\t});\n\n\t\t\t\tif (!arg) {\n\t\t\t\t\t// eslint-disable-next-line quotes\n\t\t\t\t\tthrow new Error(`Injector mapping resolution error - mapping value ` +\n\t\t\t\t\t\t`of '${mappings[argName]}' for dependency named '${argName}' of operation ` +\n\t\t\t\t\t\t`named '${invocation.operation.name}' does not exist in scope`);\n\t\t\t\t}\n\n\t\t\t\tdepsToInject.push(arg);\n\t\t\t}\n\t\t\telse if (routine.scope[argName]) {\n\t\t\t\tdepsToInject.push(routine.scope[argName]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdepsToInject.push(invocation.args);\n\t\t\t}\n\t\t}\n\n\t\tif (depsToInject.length === 1) {\n\t\t\tinvocation.args = depsToInject[0];\n\t\t}\n\t\telse if (depsToInject.length > 1) {\n\t\t\tinvocation.args = depsToInject;\n\t\t\tinvocation.hasMultipleArgs = true;\n\t\t}\n\t});\n}\n\n$injector.mappings = function (mappings) {\n\treturn (routine) => {\n\t\troutine.metadata.set(injector, {mappings});\n\t};\n};\n\nexport const injector = $injector;\n\nfunction $args (func) {\n\treturn (func + '')\n\t\t.replace(/[/][/].*$/mg, '') // strip single-line comments\n\t\t.replace(/\\s+/g, '') // strip white space\n\t\t.replace(/[/][*][^/*]*[*][/]/g, '') // strip multi-line comments\n\t\t.split('){', 1)[0].replace(/^[^(]*[(]/, '') // extract the parameters\n\t\t.replace(/=[^,]+/g, '') // strip any ES6 defaults\n\t\t.split(',').filter(Boolean); // split & filter [\"\"]\n}\n\nfunction getItemFromObjByStringPath ({obj, path} = {}) {\n\tconst props = path.split('.');\n\tlet item = obj;\n\n\tfor (let prop of props) {\n\t\titem = item[prop];\n\t\tif (!item) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn item;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/injector.js\n **/"],"sourceRoot":""}